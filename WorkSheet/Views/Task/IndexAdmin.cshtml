@model IEnumerable<WorkSheet.Models.Entity.Task>

@{
    ViewBag.Title = "IndexAdmin";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<span id="errStartDate" style="display:none" class="error">Invalid Date</span>


@using (Html.BeginForm("IndexAdmin", "Task", System.Web.Mvc.FormMethod.Get))
{
<!-- BEGIN PAGE CONTENT-->
<div class="row">
    <div class="col-md-12">

        <!-- Begin: life time stats -->
        <div class="portlet light">
            <div class="portlet-title">
                <div class="caption">
                    <i class="fa fa-gift font-green-sharp"></i>
                    <span class="caption-subject font-green-sharp bold uppercase">Record Listing</span>
                    <span class="caption-helper">manage records...</span>
                </div>
                <div class="actions">
                    <a href="javascript:;" class="btn btn-default btn-circle" onclick="ExportToExcel()">
                        <i class="fa fa-plus"></i>
                        <span class="hidden-480">
                            Export to Excel
                        </span>
                    </a>
                </div>
            </div>
            <div class="portlet-body">
                <div class="table-container">
                    <table class="table table-striped table-bordered table-hover" id="datatable_ajax">
                        <thead>
                            <tr role="row" class="heading">
                                <th width="15%">
                                    Name
                                </th>
                                <th width="15%">
                                    Start Date
                                </th>
                                <th width="10%">
                                    End Date
                                </th>
                                <th width="30%">
                                    Job
                                </th>
                                <th width="10%">
                                    Role
                                </th>
                                <th></th>
                            </tr>
                            <tr role="row" class="filter">
                                <td>
                                    @Html.TextBox("Name", null , new { @class = "form-control form-filter input-sm" })
                                </td>
                                <td>
                                    @Html.TextBox("StartDate", null, new { type = "date", format = "DD.MM.YYYY", @class = "form-control form-filter input-sm" })
                                </td>   
                                <td>
                                    @Html.TextBox("EndDate", null, new { type = "date", @class = "form-control form-filter input-sm" })
                                </td>
                                <td>
                                    @Html.DropDownList("JobId", ViewData["JobList"] as System.Web.Mvc.SelectList, string.Empty, new { @class = "form-control form-filter input-sm" })
                                </td>
                                <td>
                                    @Html.DropDownList("RoleId", ViewData["RoleList"] as System.Web.Mvc.SelectList, string.Empty, new { @class = "form-control form-filter input-sm" })
                                </td>
                                @*<td>
                                  <select name="order_status" class="form-control form-filter input-sm">
                                      <option value="">Select...</option>
                                      <option value="pending">Pending</option>
                                      <option value="closed">Closed</option>
                                      <option value="hold">On Hold</option>
                                      <option value="fraud">Fraud</option>
                                  </select>
                              </td>*@
                                <td>
                                    <div class="margin-bottom-5">
                                        <button type="submit" class="btn btn-sm yellow filter-submit margin-bottom"><i class="fa fa-search"></i>Search</button>
                                    </div>
                                </td>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- End: life time stats -->
    </div>
</div>
<!-- END PAGE CONTENT-->
}
<div class="row">
    <div class="col-md-12">
        <!-- Begin: life time stats -->
        <div class="portlet light">
            <div class="portlet-body">
                <div class="table-container">
                    <table class="table table-striped table-bordered table-hover" id="datatable_ajax">
                        <thead>
                            <tr role="row" class="heading">                               
                                <th>
                                    @Html.DisplayNameFor(model => model.User.Name)
                                </th>                               
                                <th>
                                    @Html.DisplayNameFor(model => model.Description)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.Point)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.Quantity)
                                </th>
                                <th>
                                    200 Check
                                </th>
                                <th>
                                    New Items Auto
                                </th>
                                <th>
                                    150 Price Check
                                </th>
                                <th>
                                    MP Check Change
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.Minute)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.EventDate)
                                </th>
                                @*<th>
                                    @Html.DisplayNameFor(model => model.CreateUser)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.CreateDate)
                                </th>*@
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model) {
                                <tr>                                   
                                    <td>
                                        @Html.DisplayFor(modelItem => item.User.Name)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Description)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Point)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Quantity)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Check200)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.NewItemsAutomatic)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.PriceCheck150)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.MPCheckChange)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Minute)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.EventDate)
                                    </td>
                                    @*<td>
                                            @Html.DisplayFor(modelItem => item.CreateUser)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.CreateDate)
                                     </td>*@
                                </tr>
                            }
                        </tbody>
                    </table>
                    
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/Scripts/myJS/Util.js"></script>
@section Scripts {
    <script>
        $(document).ready(function () {
            //$('.error').hide();
            //ValidateDate('11.11.2015');
            
        });
    
        

        function ExportToExcel() {
            //alert($('#StartDate').val());
            //if (isDate('14/14/2015')) 
            //    $('#errStartDate').css({ "display": "hide" });
            //else
            //    $('#errStartDate').css({ "display": "block" });
            var name = $('#Name').val();
            var surname = $('#Surname').val();
            var url = '@Url.Action("ExportData", "Task", new { @Name = "_name_", @Surname = 5 })'
                        .replace('_name_', name).replace('_surname_', surname);
            window.open(url);
        }
    </script>
}
